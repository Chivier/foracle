# 对于任务池处理的方法和测试

## 数学描述

首先对于这个问题进行一些合适的数学描述

给定一个长度为 $N$​ 的序列，$A= \{a_1, a_2,...,a_N\}$​，我们资源池中有 $M$​ 的资源，现在可以$m$​种分配模式，提供的分配资源为 $B = \{b_1, b_2, ..., b_m\}$​。

现在希望给出一个分配方案$C = \{c_1, c_2, ..., c_N\}$，$c_i \in B$，处理完 $A$ 中的所有任务，$a_i$ 的起始时间为 $t_i$，先需要在满足

$$
\forall t \in R, \; (\sum_{i \in \{j | j\in\{1, 2, ..., N\} \bigwedge t_j < t \bigwedge t < t_j + \frac{a_j}{c_j}\}} b_i) < M
$$

的同时

$$
\max_{j \in \{1, 2, ..., N\}} t_j + \frac{a_j}{c_j}
$$

最小。

此外机器的空闲占比也应当作为考虑。



## 测试方案

首先对测试任务进行构造，写于test-generate中，可以生成长度为 $length$ 的任务序列。

对于 B，M 等参数卸载 config.txt 中

使用

```bash
make generator
```

可以对任务进行编译测试。

对于 Sunway 我们可以描述为：

```bash
384 # M 64 * 6
7 # m
1 2 4 8 16 32 64 # B
```

# 数学处理

问题的处理难度之一是问题非离散，$\dfrac{a_i}{c_i}$不是整数。

所以先将$A$​序列变形处理：
$$
d_i = a_i \times [B]
$$
